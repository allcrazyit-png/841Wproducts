<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>841W å°ˆæ¡ˆï¼šæ•¸ä½ç”¢å“å±¥æ­·ä¸­å¿ƒ</title>
    <!-- ä½¿ç”¨ Tailwind CSS æ§‹å»ºç¾ä»£å·¥æ¥­ UI -->
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;700;900&display=swap');
        body { font-family: 'Inter', 'Microsoft JhengHei', sans-serif; }
        
        #imageModal { transition: opacity 0.3s ease; }
        .zoom-cursor { cursor: zoom-in; }
        
        ::-webkit-scrollbar { width: 8px; }
        ::-webkit-scrollbar-track { background: #f1f1f1; }
        ::-webkit-scrollbar-thumb { background: #cbd5e1; border-radius: 10px; }
        
        .raw-material-box {
            font-size: 1.8rem;
            line-height: 1.2;
        }
    </style>
</head>
<body class="bg-slate-50 min-h-screen p-4 md:p-6 text-slate-900 text-sm">
    <div class="max-w-7xl mx-auto">
        <!-- é ‚éƒ¨æ¨™é¡Œèˆ‡éƒ¨å“é¸æ“‡å™¨ -->
        <header class="bg-white p-5 rounded-3xl shadow-sm border border-slate-200 mb-6 flex flex-col md:flex-row justify-between items-center gap-4">
            <div class="flex items-center gap-3">
                <div class="bg-blue-600 p-2.5 rounded-2xl text-white shadow-lg shadow-blue-200">
                    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="3" stroke-linecap="round" stroke-linejoin="round"><path d="M14.5 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7.5L14.5 2z"/><polyline points="14 2 14 8 20 8"/></svg>
                </div>
                <div>
                    <h1 class="text-2xl font-black text-slate-800 tracking-tighter uppercase leading-none">841W æ•¸ä½ç”¢å“å±¥æ­·</h1>
                    <p class="text-slate-400 font-bold text-[10px] uppercase tracking-widest italic mt-1 text-nowrap tracking-tighter">Master Hub - 21 Official Items</p>
                </div>
            </div>
            <div class="flex items-center gap-4 w-full md:w-auto">
                <select id="partSelector" class="w-full md:w-[600px] bg-slate-50 border-2 border-slate-200 rounded-2xl px-5 py-3 font-black text-slate-700 focus:border-blue-500 outline-none transition-all shadow-sm text-sm"></select>
            </div>
        </header>

        <main class="grid grid-cols-1 lg:grid-cols-12 gap-6">
            <!-- å·¦å´ï¼šæ ¸å¿ƒèº«åˆ†èˆ‡ OT è¦æ ¼ -->
            <div class="lg:col-span-4 space-y-6">
                <!-- ç”¢å“ç…§ç‰‡ -->
                <div class="bg-white rounded-3xl shadow-sm border border-slate-200 overflow-hidden group border-b-4 border-b-blue-600">
                    <div class="h-56 bg-slate-100 relative overflow-hidden border-b border-slate-50 text-center flex items-center justify-center">
                        <img id="main-photo" src="" class="max-w-full max-h-full object-contain zoom-cursor transition-transform duration-500 group-hover:scale-105" onclick="openModal(this.src)" title="é»æ“Šæ”¾å¤§åœ–">
                        <div class="absolute top-4 right-4 bg-blue-600 text-white px-3 py-1 rounded-full text-[9px] font-black uppercase tracking-widest shadow-md" id="car-tag">841W</div>
                    </div>
                    <div class="p-6 space-y-4">
                        <div class="grid grid-cols-2 gap-4 border-b border-slate-50 pb-4">
                            <div class="col-span-2">
                                <span class="text-slate-400 text-[9px] font-black uppercase tracking-widest block mb-0.5 tracking-tighter">å“ç•ª (Part No.)</span>
                                <h2 id="part-no" class="text-lg font-black text-slate-800 break-words leading-none tracking-tighter uppercase">--</h2>
                            </div>
                            <div class="col-span-2 mt-2">
                                <span class="text-slate-400 text-[9px] font-black uppercase tracking-widest block mb-0.5">å®¢æˆ¶</span>
                                <p id="customer" class="font-bold text-slate-600 text-sm">--</p>
                            </div>
                        </div>
                        <div>
                            <span class="text-slate-400 text-[9px] font-black uppercase tracking-widest block mb-0.5">å“å (Part Name)</span>
                            <p id="part-name" class="font-bold text-slate-700 leading-tight">--</p>
                        </div>
                    </div>
                </div>

                <!-- ç”Ÿç”¢ OT åƒæ•¸ -->
                <div class="bg-white rounded-3xl shadow-sm border border-slate-200 p-6 space-y-4">
                    <h3 class="text-[10px] font-black text-slate-400 uppercase tracking-widest border-b pb-4 flex justify-between items-center">
                        <span>ç”Ÿç”¢åƒæ•¸ (OT Parameters)</span>
                        <span id="mold-maker" class="text-blue-600 italic font-bold text-[10px]">--</span>
                    </h3>
                    
                    <!-- åŸæ–™å€ (ç‰¹å¤§è™Ÿå­—é«”) -->
                    <div class="bg-blue-50 p-4 rounded-2xl border border-blue-100 shadow-inner">
                        <span class="text-blue-500 text-[10px] font-black uppercase tracking-widest block mb-1 tracking-tighter">é ˜æ–™å‹è™Ÿ (Raw Material)</span>
                        <span id="material" class="font-black text-blue-800 raw-material-box break-words block tracking-tighter uppercase">--</span>
                    </div>

                    <div class="grid grid-cols-2 gap-y-4 gap-x-3 px-1">
                        <div>
                            <span class="text-slate-400 text-[9px] font-black block mb-0.5 uppercase tracking-wider">ç”Ÿç”¢æ©Ÿå°</span>
                            <span id="machine" class="font-black text-slate-700">--</span>
                        </div>
                        <div>
                            <span class="text-slate-400 text-[9px] font-black block mb-0.5 uppercase tracking-wider text-nowrap">æ¨™æº– CT (ç§’)</span>
                            <span id="ct" class="font-mono font-black text-orange-600 text-lg">--</span>
                        </div>
                        <div class="col-span-2 border-t border-slate-100 pt-3 mt-1">
                            <span class="text-slate-400 text-[9px] font-black block mb-0.5 uppercase tracking-wider text-nowrap">é‡é‡è¦ç¯„ (Weight Control)</span>
                            <span id="weight" class="font-black text-blue-600 text-base">--</span>
                        </div>
                    </div>
                </div>
            </div>

            <!-- å³å´ï¼šå¾ŒåŠ å·¥ã€é»æª¢ã€SOPã€å ±è¡¨å…¥å£ -->
            <div class="lg:col-span-8 space-y-6">
                
                <!-- å¾ŒåŠ å·¥çµ„ç«‹å€å¡Š -->
                <div class="bg-emerald-50 rounded-3xl shadow-sm border border-emerald-200 p-6 border-b-4 border-b-emerald-500">
                    <h3 class="text-emerald-800 text-xs font-black uppercase tracking-widest mb-4 flex items-center gap-2">
                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round"><path d="M12 22v-7l-2-2"/><path d="M17 8l-2-2"/><path d="M19 13l-2-2"/><path d="M10 2l2 2"/><path d="M5 11l2 2"/><circle cx="12" cy="5" r="3"/></svg>
                        å¾ŒåŠ å·¥çµ„ç«‹ç¨‹åº
                    </h3>
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                        <div class="bg-white/80 p-4 rounded-2xl border border-emerald-100">
                            <span class="text-emerald-500 text-[10px] font-black uppercase block mb-1">åŠ å·¥é …ç›®</span>
                            <span id="post-process" class="font-black text-emerald-900 text-xl tracking-tighter uppercase">--</span>
                        </div>
                        <div class="bg-white/80 p-4 rounded-2xl border border-emerald-100 text-center">
                            <span class="text-emerald-500 text-[10px] font-black uppercase block mb-1">çµ„ç«‹æ™‚é–“ / æˆæœ¬ç§’æ•¸</span>
                            <span id="assy-time" class="font-black text-emerald-900 text-xl tracking-tighter uppercase">--</span>
                        </div>
                    </div>
                </div>

                <!-- é»æª¢èˆ‡æŠ€è¡“åº« (åˆ†æµé¡¯ç¤º) -->
                <div class="grid grid-cols-1 xl:grid-cols-2 gap-6">
                    <div class="bg-white rounded-3xl shadow-sm border border-slate-200 p-6">
                        <h3 class="text-xs font-black text-slate-400 uppercase tracking-widest mb-4 flex items-center gap-2 text-red-500 font-black">
                            ç¾å ´é‡é»ç®¡åˆ¶ (Key Checks)
                        </h3>
                        <div id="controls-grid" class="space-y-3"></div>
                    </div>
                    <div class="bg-white rounded-3xl shadow-sm border border-slate-200 p-6">
                        <h3 class="text-xs font-black text-slate-400 uppercase tracking-widest mb-4 flex items-center gap-2 text-blue-500 font-black">
                            æŠ€è¡“æ¨™æº–åº« (PDF Library)
                        </h3>
                        <div id="sop-grid" class="space-y-3"></div>
                    </div>
                </div>

                <!-- ç‰©æµèˆ‡å›æº¯ -->
                <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                    <div class="bg-white rounded-3xl shadow-sm border border-slate-200 p-6">
                        <div class="grid grid-cols-3 gap-4 text-center">
                            <div class="border-r border-slate-100"><span class="text-slate-400 text-[8px] font-black block mb-1 uppercase tracking-tighter">è¼‰å…·</span><span id="log-container" class="font-black text-slate-700 text-base">--</span></div>
                            <div class="border-r border-slate-100"><span class="text-slate-400 text-[8px] font-black block mb-1 uppercase tracking-tighter">æ”¶å®¹</span><span id="log-cap" class="font-black text-slate-700 text-base">--</span></div>
                            <div><span class="text-slate-400 text-[8px] font-black block mb-1 uppercase tracking-tighter text-nowrap">éœ€æ±‚é‡</span><span id="log-monthly" class="font-black text-blue-600 text-base tracking-tighter">--</span></div>
                        </div>
                    </div>
                    <div class="bg-amber-50 border-l-4 border-amber-400 p-4 rounded-r-2xl overflow-hidden shadow-inner">
                        <span class="text-amber-800 text-[9px] font-black uppercase block mb-1 tracking-widest italic tracking-wider">æ­·å²ç•°å¸¸å°ç­– (History)</span>
                        <p id="history" class="text-amber-900 text-[11px] font-bold leading-relaxed italic truncate">ç›®å‰ç„¡é‡å¤§ç•°å¸¸ç´€éŒ„ã€‚</p>
                    </div>
                </div>

                <!-- æ•¸æ“šå›å ±å…¥å£ (ä¾ç…§æŒ‡ä»¤æ”¾åœ¨æœ€åº•ç«¯) -->
                <div class="bg-gradient-to-r from-blue-700 to-indigo-800 rounded-3xl shadow-lg p-6 text-white overflow-hidden relative group mt-2">
                    <div class="flex flex-col md:flex-row justify-between items-center gap-4 relative z-10">
                        <div class="flex items-center gap-4">
                            <div class="bg-white/20 p-3 rounded-2xl backdrop-blur-md">
                                <svg xmlns="http://www.w3.org/2000/svg" width="28" height="28" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round"><path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7.5L14.5 2z"/><polyline points="14 2 14 8 20 8"/><line x1="16" y1="13" x2="8" y2="13"/><line x1="16" y1="17" x2="8" y2="17"/><line x1="10" y1="9" x2="8" y2="9"/></svg>
                            </div>
                            <div>
                                <h3 class="text-lg font-black tracking-tight">ç¾å ´æ•¸æ“šèˆ‡ç…§ç‰‡ç•°å¸¸å›å ±</h3>
                                <p class="text-blue-100 text-xs font-bold opacity-80 uppercase tracking-widest">Connect to Google Forms & Spreadsheet</p>
                            </div>
                        </div>
                        <button onclick="reportData()" class="w-full md:w-auto bg-white text-blue-800 px-10 py-3 rounded-2xl font-black text-sm shadow-xl hover:bg-blue-50 active:scale-95 transition-all">
                            é–‹å§‹ç·šä¸Šç´€éŒ„
                        </button>
                    </div>
                </div>
            </div>
        </main>
    </div>

    <!-- Lightbox Modal -->
    <div id="imageModal" class="fixed inset-0 bg-black/95 z-50 hidden flex flex-col items-center justify-center p-4" onclick="closeModal()">
        <button class="absolute top-6 right-6 text-white bg-white/20 hover:bg-white/40 p-2 rounded-full z-[60]" onclick="closeModal()">
            <svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round"><line x1="18" y1="6" x2="6" y2="18"/><line x1="6" y1="6" x2="18" y2="18"/></svg>
        </button>
        <div id="modalContent" class="w-full h-full flex items-center justify-center" onclick="event.stopPropagation()"></div>
        <p class="mt-4 text-white/50 text-[10px] font-bold uppercase tracking-widest italic uppercase">ESC to Close | Ruiquan Smart Platform</p>
    </div>

    <script>
        /**
         * ğŸ› ï¸ Google Form è¨­å®š
         */
        const GOOGLE_FORM_URL = "https://docs.google.com/forms/d/e/1FAIpQLSeD-IJiqXe4niSk_kJwEa9scGZpssZ4IxGG3K2D579LMJ8zdQ/viewform";
        const PART_NO_ENTRY_ID = "entry.1564303156"; 

        /**
         * ğŸ† æ•¸æ“šä¸­å¿ƒï¼šå®Œæ•´ 21 å€‹ç”¢å“ (åš´æ ¼ä¾ç…§é †åºå¡«å…¥ï¼Œä¸éºæ¼ä¸äº‚åŠ )
         */
        const productData = {
            'G92D1-VU010': { moldMaker: "æºé”", name: "DUCT, HV BATTERY INTAKE", image: "images/G92D1-VU010_main.jpg", customer: "å»ºä¸Š/åœ‹ç‘", machine: "550T (501æ©Ÿ)", ct: "52", weight: "93g Â± 6g", material: "FTP20DY-202B", postProcess: "ç„¡", assyTime: "ç„¡", controls: [{title: "åµŒåˆé»é»æª¢", desc: "äº”è™•åµŒåˆé»éœ€ç”¨è Ÿç­†é»æª¢", level: "Critical"}, {title: "æœ«ç«¯ç¼ºæ–™", desc: "æœ«ç«¯ç¼ºæ–™è™•é‡é»ç›®è¦–", level: "High"}, {title: "è‡ªå‹•å£“åˆ", desc: "éœ€æ‰‹å‹•å®šä½å¾Œå•Ÿå‹•è‡ªå‹•å£“åˆ", level: "High"}], sops: [{title: "æˆå½¢æ¢ä»¶è¡¨", file: "sop/G92D1-VU010_qc1.pdf"}, {title: "ä½œæ¥­æ¨™æº–æ›¸", file: "sop/G92D1-VU010_qc2.pdf"}, {title: "æª¢æŸ¥æ‰‹é †æ›¸", file: "sop/G92D1-VU010_qc3.pdf"}], container: "T62", capacity: "10", monthly: "4166" },
            '62511-VU010': { moldMaker: "æºé”", name: "å³ DECK (å¾Œå³å´èƒŒæ¿)", image: "images/62511-vu010_main.jpg", customer: "å»ºä¸Š/åœ‹ç‘", machine: "3200T (321æ©Ÿ)", ct: "80", weight: "2430g Â± 50g", material: "FTP20DY-202B", postProcess: "ç„¡", assyTime: "ç„¡", controls: [{title: "è¡¨é¢å“è³ª", desc: "å¤§å‹ä»¶ç¦æ­¢è¡¨é¢ç™¼ç™½ã€çš®ç´‹æ‹‰å‚·", level: "Critical"}], sops: [{title: "æ¢ä»¶è¡¨", file: "sop/62511-VU010_qc1.pdf"}, {title: "æ¨™æº–æ›¸", file: "sop/62511-VU010_qc2.pdf"}], container: "å°è»Š", capacity: "7", monthly: "4166" },
            '62512-VU010': { moldMaker: "æºé”", name: "å·¦ DECK (å¾Œå·¦å´èƒŒæ¿)", image: "images/62512-vu010_main.jpg", customer: "å»ºä¸Š/åœ‹ç‘", machine: "3200T (321æ©Ÿ)", ct: "80", weight: "2480g Â± 50g", material: "FTP20DY-202B", postProcess: "ç„¡", assyTime: "ç„¡", controls: [{title: "è¡¨é¢å“è³ª", desc: "å¤§å‹ä»¶ç¦æ­¢è¡¨é¢ç™¼ç™½ã€çš®ç´‹æ‹‰å‚·", level: "Critical"}], sops: [{title: "æ¢ä»¶è¡¨", file: "sop/62512-VU010_qc1.pdf"}, {title: "æ¨™æº–æ›¸", file: "sop/62512-VU010_qc2.pdf"}], container: "å°è»Š", capacity: "7", monthly: "4166" },
            '67750-VU010': { moldMaker: "åšç››é “", name: "å°¾é–€é£¾æ¿", image: "images/67750-vu010_main.jpg", customer: "å»ºä¸Š/åœ‹ç‘", machine: "2700T (312æ©Ÿ)", ct: "60", weight: "2040g Â± 45g", material: "CN-BP7SYTW", postProcess: "æœ‰ (éš”éŸ³æ£‰)", assyTime: "å¾…å¡«", controls: [{title: "ç†”æ¥å¼·åº¦", desc: "ç¢ºèª 4 è™•ç†”æ¥é»ç„¡è„«è½", level: "Critical"}], sops: [{title: "ç„Šæ¥æ¢ä»¶è¡¨", file: "sop/67750-vu010_weld.pdf"}], container: "å°è»Š", capacity: "8", monthly: "4166" },
            '67761-VU010': { moldMaker: "å¾…å¡«", name: "ç”¢å“åç¨±å¾…å¡«", image: "images/67761-VU010_main.jpg", customer: "å»ºä¸Š/åœ‹ç‘", machine: "å¾…å¡«", ct: "å¾…å¡«", weight: "å¾…å¡«", material: "å¾…å¡«", postProcess: "å¾…å¡«", assyTime: "å¾…å¡«", controls: [], sops: [], container: "å¾…å¡«", capacity: "å¾…å¡«", monthly: "4166" },
            '69321-VU010': { moldMaker: "å¾…å¡«", name: "ç”¢å“åç¨±å¾…å¡«", image: "images/69321-VU010_main.jpg", customer: "å»ºä¸Š/åœ‹ç‘", machine: "å¾…å¡«", ct: "å¾…å¡«", weight: "å¾…å¡«", material: "å¾…å¡«", postProcess: "å¾…å¡«", assyTime: "å¾…å¡«", controls: [], sops: [], container: "å¾…å¡«", capacity: "å¾…å¡«", monthly: "4166" },
            '81218-X1C00': { moldMaker: "å¾…å¡«", name: "ç”¢å“åç¨±å¾…å¡«", image: "images/81218-X1C00_main.jpg", customer: "å»ºä¸Š/åœ‹ç‘", machine: "å¾…å¡«", ct: "å¾…å¡«", weight: "å¾…å¡«", material: "å¾…å¡«", postProcess: "å¾…å¡«", assyTime: "å¾…å¡«", controls: [], sops: [], container: "å¾…å¡«", capacity: "å¾…å¡«", monthly: "4166" },
            '55303-VU010': { moldMaker: "å·¨é”", name: "IP ä¸‹æ®µ", image: "images/55303-VU010_main.jpg", customer: "å»ºä¸Š/åœ‹ç‘", machine: "2700T (312æ©Ÿ)", ct: "å¾…å¡«", weight: "1780g Â± 40g", material: "APIP5G-202B", postProcess: "ç„¡", assyTime: "ç„¡", controls: [], sops: [], container: "å°è»Š", capacity: "3", monthly: "4166" },
            '55514-VU010': { moldMaker: "ç¥æŒ¯", name: "å®‰å…¨æ°£å›Š", image: "images/55514-VU010_main.jpg", customer: "å»ºä¸Š/åœ‹ç‘", machine: "450T (502æ©Ÿ)", ct: "å¾…å¡«", weight: "339g Â± 3g", material: "TT935N1J", postProcess: "ç„¡", assyTime: "ç„¡", controls: [], sops: [], container: "å¾…å¡«", capacity: "6", monthly: "4166" },
            '62225/26-VU010': { moldMaker: "å’Œæˆ", name: "A æŸ±ä¸‹é£¾æ¿å³ (å·¦)", image: "images/62225(6)-VU010_main.jpg", customer: "å»ºä¸Š/åœ‹ç‘", machine: "550T (501æ©Ÿ)", ct: "å¾…å¡«", weight: "130g Â± 8g", material: "APIP5G-202B", postProcess: "å¾…å¡«", assyTime: "å¾…å¡«", controls: [], sops: [], container: "å¾…å¡«", capacity: "å¾…å¡«", monthly: "4166" },
            '62410/20-VU010': { moldMaker: "ç¥¥èˆˆ", name: "B æŸ±ä¸Šé£¾æ¿å³ (å·¦)", image: "images/62410(20)-VU010_main.jpg", customer: "å»ºä¸Š/åœ‹ç‘", machine: "800T (102æ©Ÿ)", ct: "å¾…å¡«", weight: "283g Â± 16g", material: "APIP5G-202B", postProcess: "å¾…å¡«", assyTime: "å¾…å¡«", controls: [], sops: [], container: "å¾…å¡«", capacity: "å¾…å¡«", monthly: "4166" },
            '624511/12-VU010': { moldMaker: "å²¡å³°", name: "å¤©äº•å´é‚Šé£¾æ¿å³ (å·¦)", image: "images/62451(2)-VU010_main.jpg", customer: "å»ºä¸Š/åœ‹ç‘", machine: "550T (501æ©Ÿ)", ct: "å¾…å¡«", weight: "154g Â± 6g", material: "CN-BP1TW-202B", postProcess: "å¾…å¡«", assyTime: "å¾…å¡«", controls: [], sops: [], container: "å¾…å¡«", capacity: "7", monthly: "4166" },
            '67917/18-VU010': { moldMaker: "å¯Œé …", name: "å¾Œé–€é£¾æ¿ (å·¦/å³)", image: "images/67917(8)-VU010_main.jpg", customer: "å»ºä¸Š/åœ‹ç‘", machine: "800T (102æ©Ÿ)", ct: "å¾…å¡«", weight: "655g Â± 10g", material: "FTP20DY-202B", postProcess: "å¾…å¡«", assyTime: "å¾…å¡«", controls: [], sops: [], container: "å¾…å¡«", capacity: "å¾…å¡«", monthly: "4166" },
            '71139-VU010': { moldMaker: "å˜‰æ³°", name: "å‰åº§è…³è“‹", image: "images/71139-VU010_main.jpg", customer: "å»ºä¸Š/æ–°ä¸‰èˆˆ", machine: "600T (æ©Ÿ)", ct: "å¾…å¡«", weight: "548g Â± 10g", material: "FTP20DY-202B", postProcess: "å¾…å¡«", assyTime: "å¾…å¡«", controls: [], sops: [], container: "å¾…å¡«", capacity: "6", monthly: "4166" },
            '71149-VU010': { moldMaker: "å˜‰æ³°", name: "å‰åº§è…³è“‹", image: "images/71149-VU010_main.jpg", customer: "å»ºä¸Š/æ–°ä¸‰èˆˆ", machine: "600T (æ©Ÿ)", ct: "å¾…å¡«", weight: "626g Â± 15g", material: "FTP20DY-202B", postProcess: "å¾…å¡«", assyTime: "å¾…å¡«", controls: [], sops: [], container: "å¾…å¡«", capacity: "6", monthly: "4166" },
            '71861/62-VU010': { moldMaker: "æºé”", name: "ä»°è‡¥å™¨å¤–è“‹", image: "images/71861(2)-VU010_main.jpg", customer: "å»ºä¸Š/æ–°ä¸‰èˆˆ", machine: "800T (102æ©Ÿ)", ct: "å¾…å¡«", weight: "RH:310gÂ±6g / LH:345gÂ±6g", material: "FTP20PDY-202B", postProcess: "å¾…å¡«", assyTime: "å¾…å¡«", controls: [], sops: [], container: "å¾…å¡«", capacity: "5", monthly: "4166" },
            '76871-VU010': { moldMaker: "åšç››é “", name: "å°¾ç¿¼ä¸Šè“‹", image: "images/76871-VU010_main.jpg", customer: "å»ºä¸Š/åœ‹ç‘", machine: "2200T (221æ©Ÿ)", ct: "å¾…å¡«", weight: "1190g Â± 10g", material: "PX18-X02", postProcess: "å¾…å¡«", assyTime: "å¾…å¡«", controls: [], sops: [], container: "å¾…å¡«", capacity: "å¾…å¡«", monthly: "4166" },
            '76876-VU010': { moldMaker: "åšç››é “", name: "å°¾ç¿¼ä¸‹è“‹", image: "images/76876-VU010_main.jpg", customer: "å»ºä¸Š/åœ‹ç‘", machine: "1500T (152æ©Ÿ)", ct: "å¾…å¡«", weight: "1310g Â± 10g", material: "TA42C-X01", postProcess: "å¾…å¡«", assyTime: "å¾…å¡«", controls: [], sops: [], container: "å¾…å¡«", capacity: "å¾…å¡«", monthly: "4166" },
            '76911/12-VU010': { moldMaker: "å¾…å¡«", name: "æ“‹æ³¥æ¿ç”¢å“åç¨±å¾…å¡«", image: "images/76911(2)-VU010_main.jpg", customer: "å»ºä¸Š/åœ‹ç‘", machine: "å¾…å¡«", ct: "å¾…å¡«", weight: "å¾…å¡«", material: "å¾…å¡«", postProcess: "å¾…å¡«", assyTime: "å¾…å¡«", controls: [], sops: [], container: "å¾…å¡«", capacity: "å¾…å¡«", monthly: "4166" },
            '76917/18-VU010': { moldMaker: "å¾…å¡«", name: "å¾Œæ“‹æ³¥æ¿ç”¢å“åç¨±å¾…å¡«", image: "images/76917(8)-VU010_main.jpg", customer: "å»ºä¸Š/åœ‹ç‘", machine: "å¾…å¡«", ct: "å¾…å¡«", weight: "å¾…å¡«", material: "å¾…å¡«", postProcess: "å¾…å¡«", assyTime: "å¾…å¡«", controls: [], sops: [], container: "å¾…å¡«", capacity: "å¾…å¡«", monthly: "4166" },
            '79236/46-VU010': { moldMaker: "æºé”", name: "åº§æ¤…è…³è“‹ç³»åˆ—", image: "images/79236(46)-VU020(010)_main.jpg", customer: "å»ºä¸Š/æ–°ä¸‰èˆˆ", machine: "800T (102æ©Ÿ)", ct: "å¾…å¡«", weight: "202g Â± 5g", material: "FTP20DY", postProcess: "å¾…å¡«", assyTime: "å¾…å¡«", controls: [], sops: [], container: "å¾…å¡«", capacity: "6", monthly: "4166" }
        };

        function reportData() {
            const currentId = document.getElementById('partSelector').value;
            const prefilledUrl = `${GOOGLE_FORM_URL}?usp=pp_url&${PART_NO_ENTRY_ID}=${encodeURIComponent(currentId)}`;
            window.open(prefilledUrl, '_blank');
        }

        function openModal(src) {
            const modal = document.getElementById('imageModal');
            const content = document.getElementById('modalContent');
            if (!src) return;
            const isPdf = src.toLowerCase().endsWith('.pdf');
            content.innerHTML = isPdf 
                ? `<iframe src="${src}" class="w-full h-full rounded-2xl bg-white shadow-2xl" type="application/pdf"></iframe>`
                : `<img src="${src}" class="max-w-full max-h-full rounded-2xl object-contain shadow-2xl">`;
            modal.classList.remove('hidden');
            document.body.style.overflow = 'hidden';
        }

        function closeModal() {
            document.getElementById('imageModal').classList.add('hidden');
            document.getElementById('modalContent').innerHTML = '';
            document.body.style.overflow = 'auto';
        }

        function updateUI(id) {
            const d = productData[id];
            if (!d) return;

            document.getElementById('main-photo').src = d.image;
            document.getElementById('part-no').textContent = id;
            document.getElementById('part-name').textContent = d.name;
            document.getElementById('customer').textContent = d.customer;
            document.getElementById('ct').textContent = d.ct;
            document.getElementById('weight').textContent = d.weight;
            document.getElementById('material').textContent = d.material;
            document.getElementById('machine').textContent = d.machine;
            document.getElementById('log-container').textContent = d.container;
            document.getElementById('log-cap').textContent = d.capacity;
            document.getElementById('log-monthly').textContent = d.monthly;
            document.getElementById('post-process').textContent = d.postProcess;
            document.getElementById('assy-time').textContent = d.assyTime;
            document.getElementById('mold-maker').textContent = `æ¨¡å…·å•†: ${d.moldMaker}`;

            // é‡é»ç®¡åˆ¶
            const controlsGrid = document.getElementById('controls-grid');
            controlsGrid.innerHTML = '';
            if (d.controls && d.controls.length > 0) {
                d.controls.forEach(ctrl => {
                    const card = document.createElement('div');
                    const accent = ctrl.level === 'Critical' ? 'border-l-red-500 bg-red-50/30' : 'border-l-blue-400 bg-blue-50/30';
                    card.className = `border border-slate-100 ${accent} border-l-4 rounded-xl p-3 shadow-sm`;
                    card.innerHTML = `<h4 class="font-black text-slate-800 text-[10px] uppercase mb-1">${ctrl.title}</h4><p class="text-[11px] text-slate-700 font-bold leading-tight">${ctrl.desc}</p>`;
                    controlsGrid.appendChild(card);
                });
            } else {
                controlsGrid.innerHTML = `<div class="col-span-3 text-center text-slate-400 text-xs italic p-4">æš«ç„¡ç´€éŒ„</div>`;
            }

            // PDF åº«
            const sopGrid = document.getElementById('sop-grid');
            sopGrid.innerHTML = '';
            if (d.sops && d.sops.length > 0) {
                d.sops.forEach(sop => {
                    const doc = document.createElement('div');
                    doc.className = "bg-white border border-slate-100 rounded-2xl p-4 flex items-center gap-4 cursor-pointer hover:bg-blue-600 hover:text-white transition-all group shadow-sm";
                    doc.onclick = () => openModal(sop.file);
                    doc.innerHTML = `<div class="bg-blue-50 p-2 rounded-xl text-blue-600 group-hover:bg-white/20 group-hover:text-white"><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5"><path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"/><polyline points="14 2 14 8 20 8"/></svg></div><div><h4 class="font-black text-xs">${sop.title}</h4><span class="text-[8px] opacity-60 font-bold uppercase tracking-widest text-nowrap">Open PDF</span></div>`;
                    sopGrid.appendChild(doc);
                });
            } else {
                sopGrid.innerHTML = `<div class="col-span-3 text-center text-slate-400 text-xs italic p-4">æš«ç„¡æ–‡ä»¶</div>`;
            }
        }

        const selector = document.getElementById('partSelector');
        Object.keys(productData).forEach(key => {
            const opt = document.createElement('option');
            opt.value = key; opt.textContent = `${key} - ${productData[key].name}`;
            selector.appendChild(opt);
        });

        selector.addEventListener('change', e => updateUI(e.target.value));
        updateUI(selector.value);

        document.addEventListener('keydown', (e) => { if (e.key === 'Escape') closeModal(); });
    </script>
</body>
</html>